<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ReserveLock ‚Äî Irrevocable Deposit Platform</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap');
    body { font-family: 'Inter', sans-serif; }
    .mono { font-family: 'JetBrains Mono', monospace; }
    .gradient-text { background: linear-gradient(135deg, #f59e0b, #ef4444); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .glass { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(12px); }
    pre { font-family: 'JetBrains Mono', monospace; font-size: 12px; }
    .animate-pulse-slow { animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
  </style>
</head>
<body class="bg-slate-950 text-white min-h-screen">
  <div id="app"></div>

  <script>
    // State Management
    const state = {
      currentView: 'landing',
      bookingStep: 1,
      selectedPayment: null,
      dashboardTab: 'deposits',
      selectedDeposit: null,
      archTab: 'overview',
      plaidConnected: false,
      consentAccepted: false
    };

    // Mock Data
    const deposits = [
      { id: 'DEP-001', guest: 'Sarah Chen', email: 'sarah@gmail.com', phone: '(415) 555-0123', date: '2026-02-07', time: '7:00 PM', party: 2, amount: 200, status: 'confirmed', method: 'ACH', bankLast4: '4521', settledAt: '2026-01-28 14:32:00', createdAt: '2026-01-28 14:30:12' },
      { id: 'DEP-002', guest: 'Marcus Johnson', email: 'marcus.j@outlook.com', phone: '(628) 555-0456', date: '2026-02-07', time: '7:30 PM', party: 4, amount: 400, status: 'confirmed', method: 'Zelle', bankLast4: '8834', settledAt: '2026-01-29 09:15:00', createdAt: '2026-01-29 09:12:45' },
      { id: 'DEP-003', guest: 'Emily Park', email: 'emilyp@icloud.com', phone: '(510) 555-0789', date: '2026-02-07', time: '8:00 PM', party: 2, amount: 200, status: 'settling', method: 'ACH', bankLast4: '2290', settledAt: null, createdAt: '2026-02-04 16:45:22' },
      { id: 'DEP-004', guest: 'David Kim', email: 'dkim@gmail.com', phone: '(650) 555-0234', date: '2026-02-08', time: '6:30 PM', party: 2, amount: 200, status: 'pending', method: null, bankLast4: null, settledAt: null, createdAt: '2026-02-05 11:20:00' },
      { id: 'DEP-005', guest: 'Jessica Liu', email: 'jliu@yahoo.com', phone: '(408) 555-0567', date: '2026-02-06', time: '7:00 PM', party: 2, amount: 200, status: 'refunded', method: 'ACH', bankLast4: '7712', settledAt: '2026-01-25 10:00:00', refundedAt: '2026-02-04 15:30:00', createdAt: '2026-01-25 09:55:00' },
      { id: 'DEP-006', guest: 'Michael Torres', email: 'mtorres@gmail.com', phone: '(925) 555-0890', date: '2026-02-05', time: '8:00 PM', party: 2, amount: 200, status: 'forfeited', method: 'Zelle', bankLast4: '3345', settledAt: '2026-01-20 12:00:00', forfeitedAt: '2026-02-05 21:00:00', createdAt: '2026-01-20 11:55:00' },
      { id: 'DEP-007', guest: 'Anna Williams', email: 'anna.w@proton.me', phone: '(415) 555-1234', date: '2026-02-08', time: '7:00 PM', party: 3, amount: 300, status: 'confirmed', method: 'USDC', bankLast4: null, walletAddr: '0x7a2...f4c1', settledAt: '2026-02-01 08:22:00', createdAt: '2026-02-01 08:20:15' },
      { id: 'DEP-008', guest: 'Robert Chang', email: 'rchang@stanford.edu', phone: '(650) 555-5678', date: '2026-02-08', time: '8:30 PM', party: 2, amount: 200, status: 'applied', method: 'ACH', bankLast4: '9901', settledAt: '2026-01-22 14:10:00', appliedAt: '2026-02-01 21:45:00', createdAt: '2026-01-22 14:05:00' },
    ];

    const stats = {
      totalDeposits: 14200,
      confirmedCount: 48,
      noShowRate: 2.1,
      prevNoShowRate: 17.8,
      chargebacks: 0,
      prevChargebacks: 6,
      avgDeposit: 225,
      conversionRate: 94.2
    };

    // Utility Functions
    function $(id) { return document.getElementById(id); }
    function render() { $('app').innerHTML = getView(); attachEvents(); lucide.createIcons(); }
    function nav(view) { state.currentView = view; render(); }
    function setBookingStep(step) { state.bookingStep = step; render(); }
    function selectPayment(method) { state.selectedPayment = method; render(); }
    function setDashboardTab(tab) { state.dashboardTab = tab; render(); }
    function setArchTab(tab) { state.archTab = tab; render(); }
    function selectDeposit(id) { state.selectedDeposit = deposits.find(d => d.id === id); render(); }
    function closeModal() { state.selectedDeposit = null; render(); }
    function toggleConsent() { state.consentAccepted = !state.consentAccepted; render(); }
    function connectPlaid() { state.plaidConnected = true; render(); }

    function getStatusColor(status) {
      const colors = {
        confirmed: 'bg-emerald-500/10 text-emerald-400 border-emerald-500/20',
        settling: 'bg-blue-500/10 text-blue-400 border-blue-500/20',
        pending: 'bg-amber-500/10 text-amber-400 border-amber-500/20',
        refunded: 'bg-slate-500/10 text-slate-400 border-slate-500/20',
        forfeited: 'bg-rose-500/10 text-rose-400 border-rose-500/20',
        applied: 'bg-purple-500/10 text-purple-400 border-purple-500/20'
      };
      return colors[status] || colors.pending;
    }

    // View Router
    function getView() {
      switch(state.currentView) {
        case 'landing': return landingView();
        case 'booking': return bookingView();
        case 'dashboard': return dashboardView();
        case 'architecture': return architectureView();
        default: return landingView();
      }
    }

    // Landing Page
    function landingView() {
      return `
        <div class="min-h-screen">
          <!-- Nav -->
          <nav class="border-b border-slate-800 sticky top-0 glass z-50">
            <div class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
              <div class="flex items-center gap-2">
                <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-amber-500 to-rose-500 flex items-center justify-center">
                  <i data-lucide="lock" class="w-4 h-4 text-white"></i>
                </div>
                <span class="font-bold text-xl">ReserveLock</span>
              </div>
              <div class="flex items-center gap-6">
                <button onclick="nav('booking')" class="text-slate-400 hover:text-white transition">Guest Demo</button>
                <button onclick="nav('dashboard')" class="text-slate-400 hover:text-white transition">Dashboard</button>
                <button onclick="nav('architecture')" class="text-slate-400 hover:text-white transition">Docs</button>
                <button class="px-4 py-2 bg-amber-500 text-white rounded-lg font-medium hover:bg-amber-600 transition">Get Started</button>
              </div>
            </div>
          </nav>

          <!-- Hero -->
          <div class="relative overflow-hidden">
            <div class="absolute inset-0 bg-gradient-to-br from-amber-500/5 via-transparent to-rose-500/5"></div>
            <div class="absolute top-20 left-1/4 w-96 h-96 bg-amber-500/10 rounded-full blur-3xl"></div>
            <div class="absolute bottom-20 right-1/4 w-96 h-96 bg-rose-500/10 rounded-full blur-3xl"></div>

            <div class="max-w-7xl mx-auto px-6 py-24 relative">
              <div class="text-center mb-16">
                <div class="inline-flex items-center gap-2 px-4 py-2 bg-amber-500/10 border border-amber-500/20 rounded-full text-amber-400 text-sm mb-6">
                  <i data-lucide="shield-check" class="w-4 h-4"></i>
                  Zero Chargebacks. Irrevocable by Design.
                </div>
                <h1 class="text-6xl font-bold mb-6">
                  Deposits That<br>
                  <span class="gradient-text">Actually Protect Revenue</span>
                </h1>
                <p class="text-xl text-slate-400 max-w-2xl mx-auto mb-8">
                  Replace reversible card holds with irrevocable cash deposits via ACH, Zelle, or USDC.
                  Built for high-demand restaurants where every seat matters.
                </p>
                <div class="flex items-center justify-center gap-4">
                  <button onclick="nav('booking')" class="px-8 py-4 bg-gradient-to-r from-amber-500 to-rose-500 text-white font-semibold rounded-xl hover:opacity-90 transition flex items-center gap-2">
                    See Guest Experience <i data-lucide="arrow-right" class="w-5 h-5"></i>
                  </button>
                  <button onclick="nav('dashboard')" class="px-8 py-4 bg-slate-800 text-white font-semibold rounded-xl hover:bg-slate-700 transition">
                    View Dashboard
                  </button>
                </div>
              </div>

              <!-- Stats -->
              <div class="grid grid-cols-4 gap-6 mb-24">
                ${[
                  { value: '87%', label: 'No-Show Reduction', sub: 'Average across customers' },
                  { value: '100%', label: 'Chargebacks Eliminated', sub: 'By design, not policy' },
                  { value: '$0.59', label: 'Cost Per Deposit', sub: 'vs $25+ per chargeback' },
                  { value: '94%', label: 'Deposit Completion', sub: 'Guest conversion rate' }
                ].map(s => `
                  <div class="bg-slate-900/50 border border-slate-800 rounded-2xl p-6 text-center">
                    <div class="text-4xl font-bold text-white mb-1">${s.value}</div>
                    <div class="text-amber-400 font-medium">${s.label}</div>
                    <div class="text-slate-500 text-sm mt-1">${s.sub}</div>
                  </div>
                `).join('')}
              </div>
            </div>
          </div>

          <!-- Problem/Solution -->
          <div class="max-w-7xl mx-auto px-6 py-16">
            <div class="grid grid-cols-2 gap-8 mb-24">
              <div class="bg-red-950/20 border border-red-900/30 rounded-2xl p-8">
                <div class="flex items-center gap-3 mb-6">
                  <div class="w-10 h-10 rounded-full bg-red-500/20 flex items-center justify-center">
                    <i data-lucide="x-circle" class="w-5 h-5 text-red-400"></i>
                  </div>
                  <h3 class="text-xl font-semibold">The Card Deposit Problem</h3>
                </div>
                <ul class="space-y-3">
                  ${[
                    'Chargebacks favor diners 95%+ of the time',
                    'Stolen card numbers used for fraudulent bookings',
                    'Holds feel "fake" ‚Äî diners treat them as optional',
                    'Complex reconciliation and settlement timing',
                    'Trapped in Visa/MC arbitration rules'
                  ].map(item => `
                    <li class="flex items-start gap-3 text-slate-300">
                      <i data-lucide="ban" class="w-5 h-5 text-red-400 mt-0.5 flex-shrink-0"></i>
                      ${item}
                    </li>
                  `).join('')}
                </ul>
              </div>
              <div class="bg-emerald-950/20 border border-emerald-900/30 rounded-2xl p-8">
                <div class="flex items-center gap-3 mb-6">
                  <div class="w-10 h-10 rounded-full bg-emerald-500/20 flex items-center justify-center">
                    <i data-lucide="check-circle" class="w-5 h-5 text-emerald-400"></i>
                  </div>
                  <h3 class="text-xl font-semibold">The Cash Deposit Solution</h3>
                </div>
                <ul class="space-y-3">
                  ${[
                    'Irrevocable once settled ‚Äî no chargebacks possible',
                    'Bank authentication prevents stolen card fraud',
                    'Real money out = real psychological commitment',
                    'Money in your account, fully reconciled',
                    'Disputes are contract law, not card network rules'
                  ].map(item => `
                    <li class="flex items-start gap-3 text-slate-300">
                      <i data-lucide="check-circle" class="w-5 h-5 text-emerald-400 mt-0.5 flex-shrink-0"></i>
                      ${item}
                    </li>
                  `).join('')}
                </ul>
              </div>
            </div>

            <!-- How It Works -->
            <div class="mb-24">
              <h2 class="text-3xl font-bold text-center mb-4">How It Works</h2>
              <p class="text-slate-400 text-center mb-12 max-w-2xl mx-auto">Five steps from booking to bill credit. Full API access at every stage.</p>
              <div class="grid grid-cols-5 gap-4">
                ${[
                  { icon: 'calendar', title: 'Guest Books', desc: 'Selects date, time, party size', api: 'POST /slots/{id}/reserve' },
                  { icon: 'file-text', title: 'Reviews Terms', desc: 'Cancellation policy + consent', api: 'GET /policies/{restaurant}' },
                  { icon: 'landmark', title: 'Links Bank', desc: 'Plaid Auth + Identity verify', api: 'POST /plaid/link/token' },
                  { icon: 'banknote', title: 'Deposit Settles', desc: 'ACH/Zelle/USDC irrevocable', api: 'POST /deposits/initiate' },
                  { icon: 'check-circle', title: 'Bill Credit', desc: 'Applied at checkout or refunded', api: 'POST /deposits/{id}/apply' }
                ].map((step, i) => `
                  <div class="relative">
                    <div class="bg-slate-900/50 border border-slate-800 rounded-xl p-5 h-full">
                      <div class="w-10 h-10 rounded-lg bg-amber-500/10 flex items-center justify-center mb-4">
                        <i data-lucide="${step.icon}" class="w-5 h-5 text-amber-400"></i>
                      </div>
                      <div class="text-white font-medium mb-1">${step.title}</div>
                      <div class="text-slate-400 text-sm mb-3">${step.desc}</div>
                      <code class="text-xs text-amber-400/70 mono">${step.api}</code>
                    </div>
                    ${i < 4 ? '<div class="absolute right-0 top-1/2 -translate-y-1/2 translate-x-1/2 z-10"><i data-lucide="chevron-right" class="w-5 h-5 text-slate-600"></i></div>' : ''}
                  </div>
                `).join('')}
              </div>
            </div>

            <!-- Payment Rails -->
            <div class="mb-24">
              <h2 class="text-3xl font-bold text-center mb-4">Payment Rails</h2>
              <p class="text-slate-400 text-center mb-12 max-w-2xl mx-auto">Production-ready integrations. All irrevocable once settled.</p>
              <div class="grid grid-cols-4 gap-6">
                ${[
                  { name: 'ACH via Dwolla', speed: '1-2 business days', cost: '$0.25/transfer', icon: 'üè¶', color: 'blue' },
                  { name: 'Zelle', speed: 'Instant', cost: 'Free', icon: '‚ö°', color: 'purple' },
                  { name: 'USDC via Circle', speed: '~2 minutes', cost: 'Free', icon: 'üíé', color: 'cyan' },
                  { name: 'Wire Transfer', speed: 'Same day', cost: '$15-25', icon: 'üîí', color: 'slate' }
                ].map(rail => `
                  <div class="bg-slate-900/50 border border-slate-800 rounded-xl p-6">
                    <div class="text-3xl mb-4">${rail.icon}</div>
                    <div class="text-white font-semibold mb-2">${rail.name}</div>
                    <div class="space-y-1 text-sm">
                      <div class="flex justify-between">
                        <span class="text-slate-500">Speed</span>
                        <span class="text-slate-300">${rail.speed}</span>
                      </div>
                      <div class="flex justify-between">
                        <span class="text-slate-500">Cost</span>
                        <span class="text-emerald-400">${rail.cost}</span>
                      </div>
                    </div>
                  </div>
                `).join('')}
              </div>
            </div>

            <!-- Cost Comparison -->
            <div class="mb-24">
              <h2 class="text-3xl font-bold text-center mb-4">Cost Per Deposit</h2>
              <p class="text-slate-400 text-center mb-12">Total cost breakdown for ACH deposits</p>
              <div class="max-w-2xl mx-auto bg-slate-900/50 border border-slate-800 rounded-2xl p-8">
                <div class="space-y-4 mb-6">
                  ${[
                    { item: 'Plaid Auth', cost: '$0.30' },
                    { item: 'Plaid Identity', cost: '$0.00', note: '(included)' },
                    { item: 'Dwolla ACH Transfer', cost: '$0.25' },
                    { item: 'Twilio SMS Confirmation', cost: '$0.04' }
                  ].map(row => `
                    <div class="flex justify-between items-center py-2 border-b border-slate-800">
                      <span class="text-slate-300">${row.item} ${row.note ? `<span class="text-slate-500">${row.note}</span>` : ''}</span>
                      <span class="text-white font-medium">${row.cost}</span>
                    </div>
                  `).join('')}
                </div>
                <div class="flex justify-between items-center py-4 bg-emerald-500/10 rounded-lg px-4">
                  <span class="text-emerald-400 font-semibold">Total Per Deposit</span>
                  <span class="text-emerald-400 font-bold text-2xl">$0.59</span>
                </div>
                <div class="mt-6 p-4 bg-red-500/10 border border-red-500/20 rounded-lg">
                  <div class="flex justify-between items-center">
                    <span class="text-slate-300">vs. Average Chargeback Cost</span>
                    <span class="text-red-400 font-bold">$25-100+</span>
                  </div>
                  <div class="text-slate-500 text-sm mt-1">Including fees, lost revenue, and labor</div>
                </div>
              </div>
            </div>

            <!-- Pricing -->
            <div class="mb-24">
              <h2 class="text-3xl font-bold text-center mb-12">Pricing</h2>
              <div class="grid grid-cols-3 gap-8 max-w-5xl mx-auto">
                ${[
                  { name: 'Starter', price: '$99', period: '/mo', desc: 'For single-location restaurants', features: ['Up to 500 deposits/mo', 'ACH + Zelle support', 'Basic dashboard', 'Email support', 'Standard widget'] },
                  { name: 'Professional', price: '$249', period: '/mo', desc: 'For high-volume establishments', features: ['Unlimited deposits', 'ACH + Zelle + USDC', 'Full analytics', 'Priority support', 'Custom branding', 'API access'], popular: true },
                  { name: 'Enterprise', price: 'Custom', period: '', desc: 'For restaurant groups', features: ['Multi-location', 'Dedicated account manager', 'Custom integrations', 'SLA guarantee', 'White-label option', 'On-premise option'] }
                ].map(tier => `
                  <div class="bg-slate-900/50 border ${tier.popular ? 'border-amber-500' : 'border-slate-800'} rounded-2xl p-8 relative ${tier.popular ? 'scale-105' : ''}">
                    ${tier.popular ? '<div class="absolute -top-3 left-1/2 -translate-x-1/2 px-4 py-1 bg-amber-500 text-white text-sm font-medium rounded-full">Most Popular</div>' : ''}
                    <div class="text-slate-400 text-sm mb-2">${tier.name}</div>
                    <div class="flex items-baseline gap-1 mb-2">
                      <span class="text-4xl font-bold text-white">${tier.price}</span>
                      <span class="text-slate-500">${tier.period}</span>
                    </div>
                    <div class="text-slate-500 text-sm mb-6">${tier.desc}</div>
                    <ul class="space-y-3 mb-8">
                      ${tier.features.map(f => `
                        <li class="flex items-center gap-2 text-slate-300 text-sm">
                          <i data-lucide="check" class="w-4 h-4 text-emerald-400"></i>
                          ${f}
                        </li>
                      `).join('')}
                    </ul>
                    <button class="w-full py-3 ${tier.popular ? 'bg-amber-500 hover:bg-amber-600' : 'bg-slate-800 hover:bg-slate-700'} text-white font-medium rounded-lg transition">
                      ${tier.price === 'Custom' ? 'Contact Sales' : 'Get Started'}
                    </button>
                  </div>
                `).join('')}
              </div>
            </div>
          </div>

          <!-- Footer -->
          <footer class="border-t border-slate-800 py-12">
            <div class="max-w-7xl mx-auto px-6 flex items-center justify-between">
              <div class="flex items-center gap-2">
                <div class="w-6 h-6 rounded bg-gradient-to-br from-amber-500 to-rose-500 flex items-center justify-center">
                  <i data-lucide="lock" class="w-3 h-3 text-white"></i>
                </div>
                <span class="font-semibold">ReserveLock</span>
              </div>
              <div class="text-slate-500 text-sm">¬© 2026 ReserveLock. All rights reserved.</div>
            </div>
          </footer>
        </div>
      `;
    }

    // Booking View
    function bookingView() {
      const steps = [
        { num: 1, label: 'Review' },
        { num: 2, label: 'Consent' },
        { num: 3, label: 'Payment' },
        { num: 4, label: 'Confirm' }
      ];

      return `
        <div class="min-h-screen bg-gradient-to-b from-slate-950 to-slate-900">
          <div class="max-w-lg mx-auto px-6 py-8">
            <!-- Back -->
            <button onclick="nav('landing')" class="flex items-center gap-2 text-slate-400 hover:text-white transition mb-8">
              <i data-lucide="arrow-left" class="w-4 h-4"></i> Back to Overview
            </button>

            <!-- Restaurant Header -->
            <div class="text-center mb-8">
              <div class="w-20 h-20 rounded-full bg-gradient-to-br from-amber-500 to-rose-500 mx-auto mb-4 flex items-center justify-center text-4xl">üç£</div>
              <h1 class="text-2xl font-bold">Omakase Sato</h1>
              <p class="text-slate-400">14-Seat Counter ‚Ä¢ $285 per person</p>
            </div>

            <!-- Progress -->
            <div class="flex items-center justify-center gap-2 mb-8">
              ${steps.map((step, i) => `
                <div class="flex items-center">
                  <div class="w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${state.bookingStep >= step.num ? 'bg-amber-500 text-white' : 'bg-slate-800 text-slate-500'}">
                    ${state.bookingStep > step.num ? '<i data-lucide="check" class="w-4 h-4"></i>' : step.num}
                  </div>
                  ${i < steps.length - 1 ? `<div class="w-8 h-0.5 ${state.bookingStep > step.num ? 'bg-amber-500' : 'bg-slate-800'}"></div>` : ''}
                </div>
              `).join('')}
            </div>

            <!-- Step Content -->
            <div class="bg-slate-900/50 border border-slate-800 rounded-2xl p-6">
              ${state.bookingStep === 1 ? `
                <h2 class="text-lg font-semibold mb-4">Review Your Reservation</h2>
                <div class="bg-slate-800/50 rounded-xl p-4 mb-6">
                  <div class="grid grid-cols-2 gap-4 text-sm">
                    <div><span class="text-slate-500">Date</span><div class="text-white">Friday, Feb 7, 2026</div></div>
                    <div><span class="text-slate-500">Time</span><div class="text-white">7:30 PM</div></div>
                    <div><span class="text-slate-500">Party</span><div class="text-white">2 guests</div></div>
                    <div><span class="text-slate-500">Deposit</span><div class="text-amber-400 font-semibold">$200.00</div></div>
                  </div>
                </div>
                <div class="bg-slate-800/30 rounded-xl p-4 mb-6">
                  <h3 class="text-white font-medium mb-2">Cancellation Policy</h3>
                  <ul class="text-slate-400 text-sm space-y-1">
                    <li>‚Ä¢ <span class="text-emerald-400">Full refund</span> if cancelled 48+ hours before</li>
                    <li>‚Ä¢ <span class="text-amber-400">50% refund</span> if cancelled 24-48 hours before</li>
                    <li>‚Ä¢ <span class="text-red-400">No refund</span> for cancellations under 24 hours or no-shows</li>
                  </ul>
                </div>
                <p class="text-slate-500 text-sm mb-6">Your deposit will be credited to your final bill or refunded per our policy.</p>
                <button onclick="setBookingStep(2)" class="w-full py-3 bg-amber-500 text-white font-semibold rounded-xl hover:bg-amber-600 transition">Continue</button>
              ` : ''}

              ${state.bookingStep === 2 ? `
                <h2 class="text-lg font-semibold mb-2">Digital Consent</h2>
                <p class="text-slate-400 text-sm mb-6">Please review and accept to proceed with your deposit.</p>
                <div class="bg-slate-800/30 rounded-xl p-4 mb-6 max-h-48 overflow-y-auto text-sm text-slate-400">
                  <p class="mb-3"><strong class="text-white">Deposit Authorization Agreement</strong></p>
                  <p class="mb-2">By proceeding, I authorize Omakase Sato to initiate an electronic funds transfer from my linked bank account in the amount of $200.00 USD as a reservation deposit.</p>
                  <p class="mb-2">I understand that:</p>
                  <ul class="list-disc list-inside space-y-1 mb-2">
                    <li>This deposit is irrevocable once the transfer settles</li>
                    <li>Refunds are subject to the cancellation policy above</li>
                    <li>The deposit will be credited to my final bill if I attend</li>
                    <li>No-shows forfeit the full deposit amount</li>
                  </ul>
                  <p>I consent to receive SMS confirmations and reminders at the phone number provided.</p>
                </div>
                <label class="flex items-start gap-3 mb-6 cursor-pointer" onclick="toggleConsent()">
                  <div class="w-5 h-5 rounded border ${state.consentAccepted ? 'bg-amber-500 border-amber-500' : 'border-slate-600'} flex items-center justify-center mt-0.5">
                    ${state.consentAccepted ? '<i data-lucide="check" class="w-3 h-3 text-white"></i>' : ''}
                  </div>
                  <span class="text-slate-300 text-sm">I have read and agree to the Deposit Authorization Agreement and Cancellation Policy</span>
                </label>
                <div class="flex gap-3">
                  <button onclick="setBookingStep(1)" class="flex-1 py-3 bg-slate-800 text-slate-300 font-semibold rounded-xl hover:bg-slate-700 transition">Back</button>
                  <button onclick="setBookingStep(3)" ${!state.consentAccepted ? 'disabled' : ''} class="flex-1 py-3 ${state.consentAccepted ? 'bg-amber-500 hover:bg-amber-600' : 'bg-slate-700 cursor-not-allowed'} text-white font-semibold rounded-xl transition">Continue</button>
                </div>
              ` : ''}

              ${state.bookingStep === 3 ? `
                <h2 class="text-lg font-semibold mb-2">Connect Payment</h2>
                <p class="text-slate-400 text-sm mb-6">Link your bank account for a secure, irrevocable deposit.</p>

                ${!state.plaidConnected ? `
                  <div class="space-y-3 mb-6">
                    ${[
                      { id: 'ach', name: 'Bank Account (ACH)', desc: 'Connect via Plaid ‚Ä¢ 1-2 days to settle', icon: 'üè¶' },
                      { id: 'zelle', name: 'Zelle', desc: 'Instant transfer ‚Ä¢ Most banks supported', icon: '‚ö°' },
                      { id: 'usdc', name: 'USDC', desc: 'Stablecoin ‚Ä¢ ~2 min settlement', icon: 'üíé' }
                    ].map(method => `
                      <button onclick="selectPayment('${method.id}')" class="w-full p-4 rounded-xl border text-left flex items-center gap-4 transition ${state.selectedPayment === method.id ? 'border-amber-500 bg-amber-500/10' : 'border-slate-700 bg-slate-800/50 hover:border-slate-600'}">
                        <span class="text-2xl">${method.icon}</span>
                        <div class="flex-1">
                          <div class="text-white font-medium">${method.name}</div>
                          <div class="text-slate-400 text-sm">${method.desc}</div>
                        </div>
                        ${state.selectedPayment === method.id ? '<i data-lucide="check-circle" class="w-5 h-5 text-amber-500"></i>' : ''}
                      </button>
                    `).join('')}
                  </div>
                  ${state.selectedPayment === 'ach' ? `
                    <button onclick="connectPlaid()" class="w-full py-4 bg-slate-800 border border-slate-700 text-white font-medium rounded-xl hover:bg-slate-700 transition flex items-center justify-center gap-3 mb-4">
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none"><rect width="24" height="24" rx="4" fill="#111"/><path d="M6 8h3v8H6V8zm4.5 0H14v8h-3.5V8zm5 0H19v8h-3.5V8z" fill="#fff"/></svg>
                      Connect with Plaid
                    </button>
                    <p class="text-slate-500 text-xs text-center">Plaid uses bank-level encryption. We never see your login credentials.</p>
                  ` : ''}
                  ${state.selectedPayment === 'zelle' ? `
                    <div class="bg-slate-800/50 rounded-xl p-4 mb-4">
                      <p class="text-slate-300 text-sm mb-2">Send $200 to:</p>
                      <div class="bg-slate-900 rounded-lg p-3 flex items-center justify-between">
                        <span class="text-white font-mono">deposits@omakasesato.com</span>
                        <button class="text-amber-400 text-sm">Copy</button>
                      </div>
                      <p class="text-slate-500 text-xs mt-2">Include confirmation code: <span class="text-amber-400 font-mono">OS-4821</span></p>
                    </div>
                  ` : ''}
                  ${state.selectedPayment === 'usdc' ? `
                    <div class="bg-slate-800/50 rounded-xl p-4 mb-4">
                      <p class="text-slate-300 text-sm mb-2">Send 200 USDC to:</p>
                      <div class="bg-slate-900 rounded-lg p-3">
                        <span class="text-white font-mono text-xs break-all">0x7a2B...f4c1</span>
                      </div>
                      <p class="text-slate-500 text-xs mt-2">Ethereum or Polygon network accepted</p>
                    </div>
                  ` : ''}
                ` : `
                  <div class="bg-emerald-500/10 border border-emerald-500/20 rounded-xl p-4 mb-6">
                    <div class="flex items-center gap-3">
                      <div class="w-10 h-10 rounded-full bg-emerald-500/20 flex items-center justify-center">
                        <i data-lucide="check-circle" class="w-5 h-5 text-emerald-400"></i>
                      </div>
                      <div>
                        <div class="text-emerald-400 font-medium">Bank Account Connected</div>
                        <div class="text-slate-400 text-sm">Chase Checking ‚Ä¢‚Ä¢‚Ä¢‚Ä¢4521</div>
                      </div>
                    </div>
                  </div>
                  <div class="bg-slate-800/50 rounded-xl p-4 mb-6">
                    <div class="flex justify-between mb-2">
                      <span class="text-slate-400">Deposit Amount</span>
                      <span class="text-white font-semibold">$200.00</span>
                    </div>
                    <div class="flex justify-between">
                      <span class="text-slate-400">Settlement</span>
                      <span class="text-slate-300">1-2 business days</span>
                    </div>
                  </div>
                `}
                <div class="flex gap-3">
                  <button onclick="setBookingStep(2)" class="flex-1 py-3 bg-slate-800 text-slate-300 font-semibold rounded-xl hover:bg-slate-700 transition">Back</button>
                  <button onclick="setBookingStep(4)" ${!state.plaidConnected ? 'disabled' : ''} class="flex-1 py-3 ${state.plaidConnected ? 'bg-amber-500 hover:bg-amber-600' : 'bg-slate-700 cursor-not-allowed'} text-white font-semibold rounded-xl transition">
                    ${state.plaidConnected ? 'Authorize $200' : 'Connect Bank First'}
                  </button>
                </div>
              ` : ''}

              ${state.bookingStep === 4 ? `
                <div class="text-center py-4">
                  <div class="w-16 h-16 rounded-full bg-emerald-500/20 flex items-center justify-center mx-auto mb-4">
                    <i data-lucide="check-circle" class="w-8 h-8 text-emerald-400"></i>
                  </div>
                  <h2 class="text-xl font-semibold mb-2">Reservation Confirmed!</h2>
                  <p class="text-slate-400 mb-6">Your deposit is processing and will settle within 1-2 business days.</p>

                  <div class="bg-slate-800/50 rounded-xl p-4 text-left mb-6">
                    <div class="space-y-3 text-sm">
                      <div class="flex justify-between"><span class="text-slate-400">Confirmation</span><span class="text-amber-400 font-mono">OS-2026-4821</span></div>
                      <div class="flex justify-between"><span class="text-slate-400">Restaurant</span><span class="text-white">Omakase Sato</span></div>
                      <div class="flex justify-between"><span class="text-slate-400">Date</span><span class="text-white">Fri, Feb 7, 2026</span></div>
                      <div class="flex justify-between"><span class="text-slate-400">Time</span><span class="text-white">7:30 PM</span></div>
                      <div class="flex justify-between"><span class="text-slate-400">Party</span><span class="text-white">2 guests</span></div>
                      <div class="flex justify-between"><span class="text-slate-400">Deposit</span><span class="text-emerald-400">$200.00</span></div>
                      <div class="flex justify-between"><span class="text-slate-400">Status</span><span class="text-blue-400">Settling</span></div>
                    </div>
                  </div>

                  <div class="bg-slate-800/30 rounded-xl p-4 mb-6">
                    <div class="w-32 h-32 bg-white rounded-lg mx-auto mb-3 flex items-center justify-center">
                      <div class="grid grid-cols-5 gap-1">
                        ${Array(25).fill(0).map(() => `<div class="w-4 h-4 ${Math.random() > 0.5 ? 'bg-slate-900' : 'bg-white'}"></div>`).join('')}
                      </div>
                    </div>
                    <p class="text-slate-500 text-sm">Show this QR code when you arrive</p>
                  </div>

                  <p class="text-slate-500 text-sm">Confirmation sent to sarah@example.com</p>
                </div>
              ` : ''}
            </div>
          </div>
        </div>
      `;
    }

    // Dashboard View
    function dashboardView() {
      const filteredDeposits = deposits;

      return `
        <div class="min-h-screen bg-slate-950">
          <!-- Sidebar -->
          <div class="fixed left-0 top-0 bottom-0 w-64 bg-slate-900/50 border-r border-slate-800 p-6">
            <div class="flex items-center gap-2 mb-8">
              <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-amber-500 to-rose-500 flex items-center justify-center">
                <i data-lucide="lock" class="w-4 h-4 text-white"></i>
              </div>
              <span class="font-bold">ReserveLock</span>
            </div>
            <div class="mb-6">
              <div class="text-slate-500 text-xs uppercase tracking-wider mb-3">Restaurant</div>
              <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-lg bg-gradient-to-br from-amber-500 to-rose-500 flex items-center justify-center text-lg">üç£</div>
                <div>
                  <div class="text-white font-medium">Omakase Sato</div>
                  <div class="text-slate-500 text-sm">14 seats</div>
                </div>
              </div>
            </div>
            <nav class="space-y-1">
              ${[
                { id: 'deposits', icon: 'banknote', label: 'Deposits' },
                { id: 'analytics', icon: 'bar-chart-3', label: 'Analytics' },
                { id: 'settings', icon: 'settings', label: 'Settings' }
              ].map(item => `
                <button onclick="setDashboardTab('${item.id}')" class="w-full flex items-center gap-3 px-3 py-2 rounded-lg transition ${state.dashboardTab === item.id ? 'bg-amber-500/10 text-amber-400' : 'text-slate-400 hover:text-white hover:bg-slate-800'}">
                  <i data-lucide="${item.icon}" class="w-5 h-5"></i>
                  ${item.label}
                </button>
              `).join('')}
            </nav>
            <div class="absolute bottom-6 left-6 right-6">
              <button onclick="nav('landing')" class="w-full flex items-center gap-2 text-slate-500 hover:text-white transition text-sm">
                <i data-lucide="arrow-left" class="w-4 h-4"></i> Back to Overview
              </button>
            </div>
          </div>

          <!-- Main Content -->
          <div class="ml-64 p-8">
            <div class="max-w-6xl">
              <div class="flex items-center justify-between mb-8">
                <div>
                  <h1 class="text-2xl font-bold">Dashboard</h1>
                  <p class="text-slate-400">Manage deposits and track performance</p>
                </div>
                <button onclick="nav('booking')" class="px-4 py-2 bg-amber-500 text-white rounded-lg font-medium hover:bg-amber-600 transition flex items-center gap-2">
                  <i data-lucide="plus" class="w-4 h-4"></i> New Booking
                </button>
              </div>

              <!-- Stats -->
              <div class="grid grid-cols-4 gap-4 mb-8">
                ${[
                  { label: 'Total Deposits', value: '$' + stats.totalDeposits.toLocaleString(), sub: 'This month', icon: 'dollar-sign', color: 'emerald' },
                  { label: 'Confirmed', value: stats.confirmedCount, sub: stats.conversionRate + '% conversion', icon: 'check-circle', color: 'blue' },
                  { label: 'No-Show Rate', value: stats.noShowRate + '%', sub: 'Down from ' + stats.prevNoShowRate + '%', icon: 'trending-down', color: 'amber' },
                  { label: 'Chargebacks', value: stats.chargebacks, sub: 'Previously ' + stats.prevChargebacks + '/mo', icon: 'shield', color: 'rose' }
                ].map(stat => `
                  <div class="bg-slate-900/50 border border-slate-800 rounded-xl p-5">
                    <div class="flex items-center justify-between mb-3">
                      <div class="w-10 h-10 rounded-lg bg-${stat.color}-500/10 flex items-center justify-center">
                        <i data-lucide="${stat.icon}" class="w-5 h-5 text-${stat.color}-400"></i>
                      </div>
                      ${stat.label === 'No-Show Rate' ? '<span class="text-emerald-400 text-sm font-medium">‚Üì 88%</span>' : ''}
                    </div>
                    <div class="text-2xl font-bold mb-1">${stat.value}</div>
                    <div class="text-slate-500 text-sm">${stat.sub}</div>
                  </div>
                `).join('')}
              </div>

              ${state.dashboardTab === 'deposits' ? `
                <!-- Deposits Table -->
                <div class="bg-slate-900/50 border border-slate-800 rounded-xl overflow-hidden">
                  <div class="p-4 border-b border-slate-800 flex items-center justify-between">
                    <h2 class="font-semibold">Recent Deposits</h2>
                    <select class="px-3 py-1.5 bg-slate-800 border border-slate-700 rounded-lg text-slate-300 text-sm">
                      <option>All Statuses</option>
                      <option>Confirmed</option>
                      <option>Settling</option>
                      <option>Pending</option>
                    </select>
                  </div>
                  <table class="w-full">
                    <thead>
                      <tr class="text-left text-slate-500 text-sm border-b border-slate-800">
                        <th class="p-4">Guest</th>
                        <th class="p-4">Reservation</th>
                        <th class="p-4">Amount</th>
                        <th class="p-4">Method</th>
                        <th class="p-4">Status</th>
                        <th class="p-4"></th>
                      </tr>
                    </thead>
                    <tbody>
                      ${filteredDeposits.map(dep => `
                        <tr class="border-b border-slate-800/50 hover:bg-slate-800/30 transition cursor-pointer" onclick="selectDeposit('${dep.id}')">
                          <td class="p-4">
                            <div class="text-white font-medium">${dep.guest}</div>
                            <div class="text-slate-500 text-sm">${dep.id}</div>
                          </td>
                          <td class="p-4 text-slate-300">${dep.date} ‚Ä¢ ${dep.time}</td>
                          <td class="p-4 text-white font-medium">$${dep.amount}</td>
                          <td class="p-4">
                            ${dep.method ? `<span class="px-2 py-1 bg-slate-800 rounded text-slate-300 text-sm">${dep.method}</span>` : '<span class="text-slate-600">‚Äî</span>'}
                          </td>
                          <td class="p-4">
                            <span class="px-2 py-1 rounded text-sm font-medium border ${getStatusColor(dep.status)}">
                              ${dep.status.charAt(0).toUpperCase() + dep.status.slice(1)}
                            </span>
                          </td>
                          <td class="p-4">
                            <i data-lucide="chevron-right" class="w-4 h-4 text-slate-600"></i>
                          </td>
                        </tr>
                      `).join('')}
                    </tbody>
                  </table>
                </div>
              ` : ''}

              ${state.dashboardTab === 'analytics' ? `
                <div class="grid grid-cols-2 gap-6">
                  <div class="bg-slate-900/50 border border-slate-800 rounded-xl p-6">
                    <h3 class="font-semibold mb-4">No-Show Rate Comparison</h3>
                    <div class="space-y-4">
                      <div>
                        <div class="flex justify-between text-sm mb-1">
                          <span class="text-slate-400">Before (Card Deposits)</span>
                          <span class="text-red-400">${stats.prevNoShowRate}%</span>
                        </div>
                        <div class="h-4 bg-slate-800 rounded-full overflow-hidden">
                          <div class="h-full bg-red-500/50 rounded-full" style="width: ${stats.prevNoShowRate * 5}%"></div>
                        </div>
                      </div>
                      <div>
                        <div class="flex justify-between text-sm mb-1">
                          <span class="text-slate-400">After (Cash Deposits)</span>
                          <span class="text-emerald-400">${stats.noShowRate}%</span>
                        </div>
                        <div class="h-4 bg-slate-800 rounded-full overflow-hidden">
                          <div class="h-full bg-emerald-500 rounded-full" style="width: ${stats.noShowRate * 5}%"></div>
                        </div>
                      </div>
                    </div>
                    <div class="mt-6 p-4 bg-emerald-500/10 border border-emerald-500/20 rounded-lg">
                      <div class="text-emerald-400 font-semibold text-lg">88% Reduction</div>
                      <div class="text-slate-400 text-sm">In no-show rate since switching</div>
                    </div>
                  </div>
                  <div class="bg-slate-900/50 border border-slate-800 rounded-xl p-6">
                    <h3 class="font-semibold mb-4">Revenue Protected</h3>
                    <div class="space-y-3">
                      <div class="flex justify-between py-3 border-b border-slate-800">
                        <span class="text-slate-400">Chargebacks Eliminated</span>
                        <span class="font-semibold">$3,600/mo</span>
                      </div>
                      <div class="flex justify-between py-3 border-b border-slate-800">
                        <span class="text-slate-400">No-Shows Prevented</span>
                        <span class="font-semibold">$12,540/mo</span>
                      </div>
                      <div class="flex justify-between py-3 border-b border-slate-800">
                        <span class="text-slate-400">Processing Fees Saved</span>
                        <span class="font-semibold">$248/mo</span>
                      </div>
                      <div class="flex justify-between py-3">
                        <span class="font-semibold">Total Monthly Benefit</span>
                        <span class="text-emerald-400 font-bold text-xl">$16,388</span>
                      </div>
                    </div>
                  </div>
                  <div class="bg-slate-900/50 border border-slate-800 rounded-xl p-6 col-span-2">
                    <h3 class="font-semibold mb-4">Deposits by Payment Method</h3>
                    <div class="grid grid-cols-3 gap-4">
                      ${[
                        { method: 'ACH', pct: 58, amt: 8236, color: 'blue' },
                        { method: 'Zelle', pct: 31, amt: 4402, color: 'purple' },
                        { method: 'USDC', pct: 11, amt: 1562, color: 'cyan' }
                      ].map(pm => `
                        <div class="bg-slate-800/50 rounded-xl p-4">
                          <div class="flex justify-between mb-3">
                            <span class="font-medium">${pm.method}</span>
                            <span class="text-slate-400">${pm.pct}%</span>
                          </div>
                          <div class="h-2 bg-slate-700 rounded-full overflow-hidden mb-2">
                            <div class="h-full bg-${pm.color}-500 rounded-full" style="width: ${pm.pct}%"></div>
                          </div>
                          <div class="text-slate-400 text-sm">$${pm.amt.toLocaleString()}</div>
                        </div>
                      `).join('')}
                    </div>
                  </div>
                </div>
              ` : ''}

              ${state.dashboardTab === 'settings' ? `
                <div class="max-w-2xl space-y-6">
                  <div class="bg-slate-900/50 border border-slate-800 rounded-xl p-6">
                    <h3 class="font-semibold mb-4">Deposit Settings</h3>
                    <div class="space-y-4">
                      <div>
                        <label class="text-slate-400 text-sm mb-2 block">Deposit Amount</label>
                        <div class="flex items-center gap-3">
                          <input type="number" value="100" class="w-32 p-3 bg-slate-800 border border-slate-700 rounded-lg text-white">
                          <span class="text-slate-400">per person</span>
                        </div>
                      </div>
                      <div>
                        <label class="text-slate-400 text-sm mb-2 block">Accepted Methods</label>
                        <div class="space-y-2">
                          ${['ACH Bank Transfer', 'Zelle', 'USDC'].map(m => `
                            <label class="flex items-center gap-3 text-slate-300 cursor-pointer">
                              <input type="checkbox" checked class="rounded bg-slate-800 border-slate-700">
                              ${m}
                            </label>
                          `).join('')}
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="bg-slate-900/50 border border-slate-800 rounded-xl p-6">
                    <h3 class="font-semibold mb-4">Cancellation Policy</h3>
                    <div class="space-y-3">
                      <div class="flex items-center gap-4">
                        <input type="number" value="48" class="w-20 p-3 bg-slate-800 border border-slate-700 rounded-lg text-white text-center">
                        <span class="text-slate-400">+ hours: Full refund</span>
                      </div>
                      <div class="flex items-center gap-4">
                        <input type="number" value="24" class="w-20 p-3 bg-slate-800 border border-slate-700 rounded-lg text-white text-center">
                        <span class="text-slate-400">- 48 hours: 50% refund</span>
                      </div>
                      <div class="flex items-center gap-4">
                        <span class="w-20 p-3 text-slate-500 text-center">Under</span>
                        <span class="text-slate-400">24 hours / No-show: No refund</span>
                      </div>
                    </div>
                    <button class="mt-6 px-6 py-2 bg-amber-500 text-white font-medium rounded-lg hover:bg-amber-600 transition">Save Settings</button>
                  </div>
                </div>
              ` : ''}
            </div>
          </div>

          <!-- Deposit Detail Modal -->
          ${state.selectedDeposit ? `
            <div class="fixed inset-0 bg-black/60 flex items-center justify-center z-50" onclick="closeModal()">
              <div class="bg-slate-900 border border-slate-800 rounded-2xl p-6 max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
                <div class="flex items-center justify-between mb-6">
                  <h3 class="text-lg font-semibold">Deposit Details</h3>
                  <button onclick="closeModal()" class="text-slate-400 hover:text-white">
                    <i data-lucide="x" class="w-5 h-5"></i>
                  </button>
                </div>
                <div class="space-y-4 mb-6">
                  <div class="flex justify-between"><span class="text-slate-400">ID</span><span class="text-amber-400 font-mono">${state.selectedDeposit.id}</span></div>
                  <div class="flex justify-between"><span class="text-slate-400">Guest</span><span>${state.selectedDeposit.guest}</span></div>
                  <div class="flex justify-between"><span class="text-slate-400">Email</span><span>${state.selectedDeposit.email}</span></div>
                  <div class="flex justify-between"><span class="text-slate-400">Phone</span><span>${state.selectedDeposit.phone}</span></div>
                  <div class="flex justify-between"><span class="text-slate-400">Reservation</span><span>${state.selectedDeposit.date} ‚Ä¢ ${state.selectedDeposit.time}</span></div>
                  <div class="flex justify-between"><span class="text-slate-400">Party Size</span><span>${state.selectedDeposit.party} guests</span></div>
                  <div class="flex justify-between"><span class="text-slate-400">Amount</span><span class="font-semibold">$${state.selectedDeposit.amount}</span></div>
                  <div class="flex justify-between"><span class="text-slate-400">Method</span><span>${state.selectedDeposit.method || '‚Äî'}</span></div>
                  ${state.selectedDeposit.bankLast4 ? `<div class="flex justify-between"><span class="text-slate-400">Account</span><span>‚Ä¢‚Ä¢‚Ä¢‚Ä¢${state.selectedDeposit.bankLast4}</span></div>` : ''}
                  ${state.selectedDeposit.walletAddr ? `<div class="flex justify-between"><span class="text-slate-400">Wallet</span><span class="font-mono text-sm">${state.selectedDeposit.walletAddr}</span></div>` : ''}
                  <div class="flex justify-between"><span class="text-slate-400">Status</span><span class="px-2 py-1 rounded text-sm font-medium border ${getStatusColor(state.selectedDeposit.status)}">${state.selectedDeposit.status.charAt(0).toUpperCase() + state.selectedDeposit.status.slice(1)}</span></div>
                </div>

                <div class="bg-slate-800/50 rounded-xl p-4 mb-6">
                  <h4 class="text-sm font-medium mb-3 text-slate-400">Audit Trail</h4>
                  <div class="space-y-2 text-sm">
                    <div class="flex gap-3"><span class="text-slate-500 w-36">${state.selectedDeposit.createdAt}</span><span class="text-slate-300">Deposit initiated</span></div>
                    ${state.selectedDeposit.settledAt ? `<div class="flex gap-3"><span class="text-slate-500 w-36">${state.selectedDeposit.settledAt}</span><span class="text-emerald-400">Funds settled</span></div>` : ''}
                    ${state.selectedDeposit.appliedAt ? `<div class="flex gap-3"><span class="text-slate-500 w-36">${state.selectedDeposit.appliedAt}</span><span class="text-purple-400">Applied to bill</span></div>` : ''}
                    ${state.selectedDeposit.refundedAt ? `<div class="flex gap-3"><span class="text-slate-500 w-36">${state.selectedDeposit.refundedAt}</span><span class="text-slate-400">Refunded</span></div>` : ''}
                    ${state.selectedDeposit.forfeitedAt ? `<div class="flex gap-3"><span class="text-slate-500 w-36">${state.selectedDeposit.forfeitedAt}</span><span class="text-rose-400">Forfeited (no-show)</span></div>` : ''}
                  </div>
                </div>

                ${state.selectedDeposit.status === 'confirmed' ? `
                  <div class="flex gap-3">
                    <button class="flex-1 py-2 bg-slate-800 text-slate-300 font-medium rounded-lg hover:bg-slate-700 transition">Send Reminder</button>
                    <button class="flex-1 py-2 bg-rose-500/10 text-rose-400 font-medium rounded-lg hover:bg-rose-500/20 transition">Refund</button>
                  </div>
                ` : ''}
              </div>
            </div>
          ` : ''}
        </div>
      `;
    }

    // Architecture View (continued in next part)
    function architectureView() {
      return `
        <div class="min-h-screen bg-slate-950">
          <div class="max-w-6xl mx-auto px-6 py-8">
            <button onclick="nav('landing')" class="flex items-center gap-2 text-slate-400 hover:text-white transition mb-8">
              <i data-lucide="arrow-left" class="w-4 h-4"></i> Back to Overview
            </button>

            <h1 class="text-3xl font-bold mb-2">Architecture & Implementation</h1>
            <p class="text-slate-400 mb-8">Complete technical documentation for integrating ReserveLock</p>

            <!-- Tabs -->
            <div class="flex gap-1 mb-8 bg-slate-900/50 p-1 rounded-lg w-fit">
              ${['overview', 'plaid', 'payments', 'webhooks', 'widget'].map(tab => `
                <button onclick="setArchTab('${tab}')" class="px-4 py-2 rounded-md text-sm font-medium transition ${state.archTab === tab ? 'bg-slate-800 text-white' : 'text-slate-400 hover:text-white'}">
                  ${tab.charAt(0).toUpperCase() + tab.slice(1)}
                </button>
              `).join('')}
            </div>

            ${state.archTab === 'overview' ? `
              <div class="grid grid-cols-3 gap-6 mb-8">
                ${[
                  { name: 'Plaid', role: 'Bank linking + identity', cost: '$0.30/link' },
                  { name: 'Dwolla', role: 'ACH processing', cost: '$0.25/transfer' },
                  { name: 'Circle', role: 'USDC settlement', cost: 'Free' }
                ].map(svc => `
                  <div class="bg-slate-900/50 border border-slate-800 rounded-xl p-5">
                    <div class="text-white font-semibold mb-1">${svc.name}</div>
                    <div class="text-slate-400 text-sm mb-2">${svc.role}</div>
                    <div class="text-emerald-400 text-sm">${svc.cost}</div>
                  </div>
                `).join('')}
              </div>
              <div class="bg-slate-900/50 border border-slate-800 rounded-xl p-6">
                <h3 class="font-semibold mb-4">System Architecture</h3>
                <pre class="text-slate-300 text-sm overflow-x-auto">
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Guest     ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  ReserveLock‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  Restaurant ‚îÇ
‚îÇ   Browser   ‚îÇ     ‚îÇ     API     ‚îÇ     ‚îÇ   Dashboard ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ                  ‚îÇ                  ‚îÇ
        ‚ñº                  ‚ñº                  ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    Plaid    ‚îÇ     ‚îÇ   Dwolla    ‚îÇ     ‚îÇ   Circle    ‚îÇ
‚îÇ  Bank Auth  ‚îÇ     ‚îÇ     ACH     ‚îÇ     ‚îÇ    USDC     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                </pre>
              </div>
            ` : ''}

            ${state.archTab === 'plaid' ? `
              <div class="space-y-6">
                <div class="bg-slate-900/50 border border-slate-800 rounded-xl p-6">
                  <h3 class="font-semibold mb-4">1. Create Link Token</h3>
                  <pre class="bg-slate-950 rounded-lg p-4 overflow-x-auto text-sm"><code class="text-emerald-400">// POST /api/plaid/link/token
const response = await plaidClient.linkTokenCreate({
  user: { client_user_id: uniqueUserId },
  client_name: 'ReserveLock',
  products: ['auth', 'identity'],
  country_codes: ['US'],
  language: 'en',
});
return { link_token: response.data.link_token };</code></pre>
                </div>
                <div class="bg-slate-900/50 border border-slate-800 rounded-xl p-6">
                  <h3 class="font-semibold mb-4">2. Exchange Public Token</h3>
                  <pre class="bg-slate-950 rounded-lg p-4 overflow-x-auto text-sm"><code class="text-emerald-400">// POST /api/plaid/exchange
const tokenResponse = await plaidClient.itemPublicTokenExchange({
  public_token: publicToken
});

const authResponse = await plaidClient.authGet({
  access_token: tokenResponse.data.access_token
});

// Store processor token for Dwolla
const processorToken = await plaidClient.processorTokenCreate({
  access_token: tokenResponse.data.access_token,
  account_id: authResponse.data.accounts[0].account_id,
  processor: 'dwolla'
});</code></pre>
                </div>
              </div>
            ` : ''}

            ${state.archTab === 'payments' ? `
              <div class="space-y-6">
                <div class="bg-slate-900/50 border border-slate-800 rounded-xl p-6">
                  <h3 class="font-semibold mb-4">Dwolla ACH Transfer</h3>
                  <pre class="bg-slate-950 rounded-lg p-4 overflow-x-auto text-sm"><code class="text-emerald-400">// POST /api/deposits/initiate
const transfer = await dwollaClient.post('transfers', {
  _links: {
    source: { href: customerFundingSourceUrl },
    destination: { href: restaurantFundingSourceUrl }
  },
  amount: {
    currency: 'USD',
    value: depositAmount.toFixed(2)
  },
  metadata: {
    reservationId,
    restaurantId,
    guestEmail
  }
});

// Webhook handles settlement confirmation
// Transfer is IRREVOCABLE once status = 'processed'</code></pre>
                </div>
                <div class="bg-slate-900/50 border border-slate-800 rounded-xl p-6">
                  <h3 class="font-semibold mb-4">Circle USDC</h3>
                  <pre class="bg-slate-950 rounded-lg p-4 overflow-x-auto text-sm"><code class="text-emerald-400">// Generate payment address
const payment = await circleClient.createPayment({
  amount: { amount: '200.00', currency: 'USD' },
  settlementCurrency: 'USD',
  paymentMethods: [{ type: 'blockchain', chain: 'ETH' }]
});

// Returns wallet address for guest to send USDC
// Settlement typically 2-5 minutes on Ethereum</code></pre>
                </div>
              </div>
            ` : ''}

            ${state.archTab === 'webhooks' ? `
              <div class="space-y-6">
                <div class="bg-slate-900/50 border border-slate-800 rounded-xl p-6">
                  <h3 class="font-semibold mb-4">Webhook Handler</h3>
                  <pre class="bg-slate-950 rounded-lg p-4 overflow-x-auto text-sm"><code class="text-emerald-400">// POST /webhooks/dwolla
app.post('/webhooks/dwolla', async (req, res) => {
  const { topic, resourceId } = req.body;

  switch (topic) {
    case 'transfer_completed':
      // Deposit is now IRREVOCABLE
      await db.deposits.update({
        where: { transferId: resourceId },
        data: {
          status: 'confirmed',
          settledAt: new Date()
        }
      });
      await sendConfirmationSMS(deposit.guestPhone);
      break;

    case 'transfer_failed':
      await db.deposits.update({
        where: { transferId: resourceId },
        data: { status: 'failed' }
      });
      await notifyRestaurant(deposit.restaurantId);
      break;
  }

  res.status(200).send('OK');
});</code></pre>
                </div>
                <div class="bg-slate-900/50 border border-slate-800 rounded-xl p-6">
                  <h3 class="font-semibold mb-4">Refund Engine</h3>
                  <pre class="bg-slate-950 rounded-lg p-4 overflow-x-auto text-sm"><code class="text-emerald-400">async function processRefund(depositId, reason) {
  const deposit = await db.deposits.findUnique({
    where: { id: depositId },
    include: { reservation: true, restaurant: true }
  });

  const hoursUntilReservation = differenceInHours(
    deposit.reservation.dateTime,
    new Date()
  );

  const policy = deposit.restaurant.cancellationPolicy;
  let refundPercent = 0;

  if (hoursUntilReservation >= policy.fullRefundHours) {
    refundPercent = 100;
  } else if (hoursUntilReservation >= policy.partialRefundHours) {
    refundPercent = policy.partialRefundPercent;
  }
  // else: no refund (no-show or late cancel)

  if (refundPercent > 0) {
    const refundAmount = deposit.amount * (refundPercent / 100);
    await initiateRefundTransfer(deposit, refundAmount);
  }

  return { refundPercent, refundAmount };
}</code></pre>
                </div>
              </div>
            ` : ''}

            ${state.archTab === 'widget' ? `
              <div class="space-y-6">
                <div class="bg-slate-900/50 border border-slate-800 rounded-xl p-6">
                  <h3 class="font-semibold mb-4">Embed Code</h3>
                  <pre class="bg-slate-950 rounded-lg p-4 overflow-x-auto text-sm"><code class="text-amber-400">&lt;!-- Add to your website --&gt;
&lt;script src="https://cdn.reservelock.com/widget.js"&gt;&lt;/script&gt;
&lt;div id="reservelock-widget"
  data-restaurant-id="rst_abc123"
  data-theme="dark"
  data-accent-color="#f59e0b"
&gt;&lt;/div&gt;

&lt;script&gt;
  ReserveLock.init({
    onSuccess: (reservation) =&gt; {
      console.log('Booking confirmed:', reservation.id);
    },
    onError: (error) =&gt; {
      console.error('Booking failed:', error);
    }
  });
&lt;/script&gt;</code></pre>
                </div>
                <div class="bg-slate-900/50 border border-slate-800 rounded-xl p-6">
                  <h3 class="font-semibold mb-4">Go-to-Market</h3>
                  <div class="grid grid-cols-2 gap-6">
                    <div>
                      <h4 class="text-amber-400 font-medium mb-2">Phase 1: Launch (Weeks 1-4)</h4>
                      <ul class="text-slate-400 text-sm space-y-1">
                        <li>‚Ä¢ 5-10 pilot restaurants in SF Bay Area</li>
                        <li>‚Ä¢ Focus on high-end omakase, tasting menus</li>
                        <li>‚Ä¢ White-glove onboarding</li>
                      </ul>
                    </div>
                    <div>
                      <h4 class="text-amber-400 font-medium mb-2">Phase 2: Scale (Months 2-6)</h4>
                      <ul class="text-slate-400 text-sm space-y-1">
                        <li>‚Ä¢ Expand to NYC, LA, Chicago</li>
                        <li>‚Ä¢ POS integrations (Toast, Square)</li>
                        <li>‚Ä¢ Resy/OpenTable partnerships</li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="bg-amber-500/10 border border-amber-500/20 rounded-xl p-6">
                  <h3 class="font-semibold mb-2">Infrastructure Cost</h3>
                  <p class="text-slate-400 text-sm mb-4">Monthly operational cost for MVP deployment</p>
                  <div class="grid grid-cols-4 gap-4 text-center">
                    <div><div class="text-2xl font-bold">$99</div><div class="text-slate-500 text-sm">Plaid</div></div>
                    <div><div class="text-2xl font-bold">$100</div><div class="text-slate-500 text-sm">Dwolla</div></div>
                    <div><div class="text-2xl font-bold">$50</div><div class="text-slate-500 text-sm">Twilio</div></div>
                    <div><div class="text-2xl font-bold text-emerald-400">~$250</div><div class="text-slate-500 text-sm">Total/mo</div></div>
                  </div>
                </div>
              </div>
            ` : ''}
          </div>
        </div>
      `;
    }

    function attachEvents() {
      // Events are handled via onclick attributes
    }

    // Initial render
    render();
  </script>
</body>
</html>
